
@baseUrl = http://127.0.0.1:8000/api/accounts
@phoneNumber = 0684499227
@countryCode = +212

### 1. Demande d'envoi OTP
# @name requestOtp
POST {{baseUrl}}/auth/phone/
Content-Type: application/json

{
    "phone_number": "{{phoneNumber}}",
    "country_code": "{{countryCode}}"
}

### 2. Vérification OTP
# @prompt otpCode Entrez le code reçus par SMS
# @name verifyOtp
POST {{baseUrl}}/auth/verify/
Content-Type: application/json

{
    "phone_number": "{{requestOtp.response.body.phone_number}}",
    "code": "{{otpCode}}",
    "session_key": "{{requestOtp.response.body.session_key}}"
}

@authToken = {{verifyOtp.response.body.auth.access_token}}

### 3. GET Profil utilisateur
GET {{baseUrl}}/profile/
Authorization: Bearer {{authToken}}

### 4. PATCH Profil utilisateur
PATCH {{baseUrl}}/profile/
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
    "first_name": "Jean",
    "last_name": "Dupont",
    "email": "jean.dupont@example.com"
}

### 5. POST document KYC (id_verificationViews)
# Note: multipart/form-data requests should be sent as a single body block, 
# and boundaries must be handled by your HTTP client, not inlined in the request.
# Remove manual boundaries, put fields in standard multipart form-data syntax instead:
POST {{baseUrl}}/kyc/verify/
Authorization: Bearer {{authToken}}
Content-Type: multipart/form-data

# form fields:
# document_type: id_card
# front_image: (binary file: ./files/front.jpeg)
# back_image: (binary file: ./files/back.jpeg)
# Example syntax for most HTTP client tools:

--form 'document_type=id_card' \
--form 'front_image=@./files/front.jpeg;type=image/jpeg' \
--form 'back_image=@./files/back.jpeg;type=image/jpeg'

### 6. GET statut KYC (id_verificationViews)
GET {{baseUrl}}/kyc/status/
Authorization: Bearer {{authToken}}

### 7. Lister documents KYC (id_verificationViews)
GET {{baseUrl}}/kyc/documents/
Authorization: Bearer {{authToken}}

### 8. Tester endpoints techniques (optionnels)
GET {{baseUrl}}/debug-otp/

### 9. Demande suppression de compte
# @name requestDelete
POST {{baseUrl}}/account/delete/
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
    "confirmation": "SUPPRIMER MON COMPTE"
}

### 10. Confirmation suppression (OTP)
# @prompt deleteOtp Entrez le code reçu pour suppression
POST {{baseUrl}}/account/delete/confirm/
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
    "otp": "{{deleteOtp}}",
    "session_uuid": "{{requestDelete.response.body.session_uuid}}"
}

### 11. Déconnexion utilisateur (logout)
POST {{baseUrl}}/logout/
Authorization: Bearer {{authToken}}

